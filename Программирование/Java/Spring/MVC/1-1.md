–û—Ç–ª–∏—á–Ω–æ! –î–æ–ø–æ–ª–Ω—é —Ç–≤–æ–π –∫–æ–Ω—Å–ø–µ–∫—Ç –∫–ª—é—á–µ–≤—ã–º–∏ –º–æ–º–µ–Ω—Ç–∞–º–∏, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–º–æ–≥—É—Ç –æ—Ç–≤–µ—Ç–∏—Ç—å –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã –º–æ–∫-—Å–æ–±–µ—Å–∞. –°—Ñ–æ–∫—É—Å–∏—Ä—É–µ–º—Å—è –Ω–∞ –≥–ª—É–±–∏–Ω–µ –∏ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏—Ö –∞—Å–ø–µ–∫—Ç–∞—Ö:

---

### üö¶ **–î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è —Ä–∞–±–æ—Ç—ã Spring MVC**  
**Flow –∑–∞–ø—Ä–æ—Å–∞:**  
`HTTP Request ‚Üí DispatcherServlet (front-controller) ‚Üí HandlerMapping (–∏—â–µ—Ç –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä) ‚Üí @Controller ‚Üí @Service ‚Üí @Repository ‚Üí DB ‚Üí DTO ‚Üí ViewResolver (–¥–ª—è HTML) / MessageConverter (–¥–ª—è JSON) ‚Üí HTTP Response`

- **DispatcherServlet:** –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –¥–∏—Å–ø–µ—Ç—á–µ—Ä, –∫–æ–æ—Ä–¥–∏–Ω–∏—Ä—É–µ—Ç –≤–µ—Å—å –ø—Ä–æ—Ü–µ—Å—Å
- **HandlerMapping:** –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç, –∫–∞–∫–æ–π `@Controller` –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∑–∞–ø—Ä–æ—Å
- **ViewResolver:** –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –∏–º—è view (–Ω–∞–ø—Ä–∏–º–µ—Ä, `"users"`) –≤ HTML-—à–∞–±–ª–æ–Ω (Thymeleaf/JSP)
- **HttpMessageConverters:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É—é—Ç DTO ‚Üî JSON (Jackson)

---

### üéØ **–ö–ª—é—á–µ–≤—ã–µ –∞–Ω–Ω–æ—Ç–∞—Ü–∏–∏: —Ä–∞–∑–ª–∏—á–∏—è**
| –ê–Ω–Ω–æ—Ç–∞—Ü–∏—è       | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ                          | –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏                          |
|-----------------|-------------------------------------|--------------------------------------|
| `@Controller`   | –û–±—Ä–∞–±–æ—Ç–∫–∞ HTTP-–∑–∞–ø—Ä–æ—Å–æ–≤             | –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∏–º—è view (+ Model)        |
| `@RestController` | –î–ª—è REST API                        | = `@Controller` + `@ResponseBody` –Ω–∞ –≤—Å–µ—Ö –º–µ—Ç–æ–¥–∞—Ö |
| `@Service`      | –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞                       | –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏, –≤—ã–∑–æ–≤ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤ |
| `@Repository`   | –†–∞–±–æ—Ç–∞ —Å –ë–î                         | –ü–µ—Ä–µ—Ö–≤–∞—Ç SQL-–æ—à–∏–±–æ–∫ ‚Üí Spring DataExceptions |

**–í–∞–∂–Ω–æ:**  
```java
@Repository // ‚ùå –ù–ï–í–ï–†–ù–û! –ù–∞—Ä—É—à–∞–µ—Ç —Å–µ–º–∞–Ω—Ç–∏–∫—É
public class UserService { ... }
```
‚Üí Spring –¥–æ–±–∞–≤–∏—Ç –Ω–µ–Ω—É–∂–Ω—ã–µ SQL-–∏—Å–∫–ª—é—á–µ–Ω–∏—è –≤ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É ‚Üí —Å–ª–æ–∂–Ω–æ –æ—Ç–ª–∞–∂–∏–≤–∞—Ç—å

---

### ‚ö° `@Controller` vs `@RestController`
**–ö–æ–≥–¥–∞ —á—Ç–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
| –¢–∏–ø –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è      | –ê–Ω–Ω–æ—Ç–∞—Ü–∏—è       | –í–æ–∑–≤—Ä–∞—â–∞–µ–º—ã–µ –¥–∞–Ω–Ω—ã–µ | –ü—Ä–∏–º–µ—Ä                |
|---------------------|-----------------|----------------------|-----------------------|
| –í–µ–±-—Å–∞–π—Ç (HTML)     | `@Controller`   | –ò–º—è view + Model     | `return "users-page";` |
| REST API (JSON/XML) | `@RestController` | DTO –Ω–∞–ø—Ä—è–º—É—é         | `return userService.getDto();` |

**–ü–æ—á–µ–º—É `@RestController` = `@Controller` + `@ResponseBody`?**  
‚Üí –ê–Ω–Ω–æ—Ç–∞—Ü–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–æ—Ä–∞—á–∏–≤–∞–µ—Ç –≤–æ–∑–≤—Ä–∞—â–∞–µ–º—ã–π –æ–±—ä–µ–∫—Ç –≤ JSON —á–µ—Ä–µ–∑ Jackson

---

### üõ°Ô∏è **–û–±—Ä–∞–±–æ—Ç–∫–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–π**
**–ì–ª–æ–±–∞–ª—å–Ω—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫:**
```java
@ControllerAdvice
public class GlobalExceptionHandler {
    
    @ResponseStatus(HttpStatus.INTERNAL_SERVER_ERROR)
    @ExceptionHandler(NullPointerException.class)
    public @ResponseBody ErrorDto handleNPE(NullPointerException ex) {
        return new ErrorDto("–û—à–∏–±–∫–∞ 500: " + ex.getMessage());
    }
}
```

**–ì–¥–µ –ª–æ–≤–∏—Ç—å:**
- –°–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –±–∏–∑–Ω–µ—Å-–æ—à–∏–±–∫–∏ ‚Üí –≤ `@Service` (e.g., `UserNotFoundException`)
- –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏ (DB, IO) ‚Üí –≥–ª–æ–±–∞–ª—å–Ω–æ —á–µ—Ä–µ–∑ `@ControllerAdvice`

---

### üö´ **Jackson: –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–ª–µ–π**
```java
public class User {
    @JsonIgnore // –ò–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–∏ —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏
    private String password;
    
    @JsonIgnoreProperties(ignoreUnknown = true) // –ò–≥–Ω–æ—Ä –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã—Ö –ø–æ–ª–µ–π
    public static class Dto { ... }
}
```

---

### ‚ö†Ô∏è **–†–∏—Å–∫–∏ –≤–æ–∑–≤—Ä–∞—Ç–∞ Entity –≤–º–µ—Å—Ç–æ DTO**
```java
@GetMapping("/users")
public List<User> getUsers() {
    return repository.findAll(); // ‚ùå –û–ø–∞—Å–Ω—ã–π –ø–æ–¥—Ö–æ–¥!
}
```
**–ü—Ä–æ–±–ª–µ–º—ã:**  
1. –£—Ç–µ—á–∫–∞ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö (–ø–∞—Ä–æ–ª–∏, –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ ID)  
2. –¶–∏–∫–ª–∏—á–µ—Å–∫–∏–µ —Å—Å—ã–ª–∫–∏ (`User` ‚Üí `Order` ‚Üí `User`) ‚Üí StackOverflowError  
3. –ò–∑–±—ã—Ç–æ—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (–ø–æ–ª—è, –Ω–µ –Ω—É–∂–Ω—ã–µ –∫–ª–∏–µ–Ω—Ç—É)  

**–†–µ—à–µ–Ω–∏–µ:**  
```java
// MapStruct (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –º–∞–ø–ø–∏–Ω–≥)
@Mapper
public interface UserMapper {
    UserDto toDto(User user);
}
```

---

### üß© **–¢—Ä–µ—Ö—É—Ä–æ–≤–Ω–µ–≤–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞**
| –£—Ä–æ–≤–µ–Ω—å         | –ê–Ω–Ω–æ—Ç–∞—Ü–∏—è     | –û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å                     | –ü—Ä–∏–º–µ—Ä –∫–æ–¥–∞                  |
|-----------------|---------------|-------------------------------------|------------------------------|
| –ü—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏–æ–Ω–Ω—ã–π | `@Controller` | –ü—Ä–∏—ë–º –∑–∞–ø—Ä–æ—Å–æ–≤, –≤–∞–ª–∏–¥–∞—Ü–∏—è –≤–≤–æ–¥–∞     | `@PostMapping("/users")`     |
| –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞   | `@Service`    | –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏, –≤—ã–∑–æ–≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤      | `userService.register()`     |
| –î–∞–Ω–Ω—ã–µ          | `@Repository` | –†–∞–±–æ—Ç–∞ —Å –ë–î/–≤–Ω–µ—à–Ω–∏–º–∏ –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º–∏    | `userRepository.save()`      |

---

### ‚ò†Ô∏è **–ü–æ—á–µ–º—É JSP —É—Å—Ç–∞—Ä–µ–ª?**  
- –°–ª–æ–∂–Ω–∞—è –æ—Ç–ª–∞–¥–∫–∞  
- –°–º–µ—à–∏–≤–∞–Ω–∏–µ Java-–∫–æ–¥–∞ –∏ HTML  
- –ü–ª–æ—Ö–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤  
**–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã:**  
```java
// Thymeleaf (HTML-—à–∞–±–ª–æ–Ω—ã)
@Controller
public class WebController {
    @GetMapping("/")
    public String home(Model model) {
        model.addAttribute("message", "Hello!");
        return "index"; // src/main/resources/templates/index.html
    }
}
```

---

### üîÑ **–ü–æ–ª–Ω—ã–π flow —Å –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π**
1. **`@Controller`**  
   ‚Üí –í–∞–ª–∏–¥–∞—Ü–∏—è –≤–≤–æ–¥–∞ (`@Valid`)  
   ‚Üí –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ DTO ‚Üí Entity  
2. **`@Service`**  
   ‚Üí –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞  
   ‚Üí –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è–º–∏ (`@Transactional`)  
3. **`@Repository`**  
   ‚Üí –†–∞–±–æ—Ç–∞ —Å –ë–î  
4. **–û–±—Ä–∞—Ç–Ω–æ:**  
   ‚Üí –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ Entity ‚Üí DTO (–≤ `@Service`/`@Controller`)  
   ‚Üí –°–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è –≤ JSON –∏–ª–∏ –ø–µ—Ä–µ–¥–∞—á–∞ –≤ View  

–¢–∞–∫–æ–π –∫–æ–Ω—Å–ø–µ–∫—Ç –∑–∞–∫—Ä—ã–≤–∞–µ—Ç –≤—Å–µ –≤–æ–ø—Ä–æ—Å—ã —Å–æ–±–µ—Å–∞, —Å–æ—Ö—Ä–∞–Ω—è—è –±–∞–ª–∞–Ω—Å –º–µ–∂–¥—É –∫—Ä–∞—Ç–∫–æ—Å—Ç—å—é –∏ –≥–ª—É–±–∏–Ω–æ–π. –£–ø–æ—Ä –Ω–∞ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –Ω—é–∞–Ω—Å—ã, –∫–æ—Ç–æ—Ä—ã–µ —Ä–µ–∞–ª—å–Ω–æ —Å–ø—Ä–æ—Å—è—Ç! üí™