# üìÑ **Transaction (–¢—Ä–∞–Ω–∑–∞–∫—Ü–∏—è)**

### üìù **–ß—Ç–æ —ç—Ç–æ –∏ –∑–∞—á–µ–º –Ω—É–∂–Ω–æ**

**–¢—Ä–∞–Ω–∑–∞–∫—Ü–∏—è** ‚Äî —ç—Ç–æ –µ–¥–∏–Ω–∏—Ü–∞ —Ä–∞–±–æ—Ç—ã —Å –¥–∞–Ω–Ω—ã–º–∏, –∫–æ—Ç–æ—Ä–∞—è –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è **–∞—Ç–æ–º–∞—Ä–Ω–æ**: –ª–∏–±–æ —É—Å–ø–µ—à–Ω–æ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –≤—Å–µ –µ—ë —à–∞–≥–∏, –ª–∏–±–æ –Ω–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –Ω–∏ –æ–¥–∏–Ω.  
–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ [[Database|–±–∞–∑–∞—Ö –¥–∞–Ω–Ω—ã—Ö]], [[Microservices|–º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞—Ö]], —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö –∏ –±–∏–∑–Ω–µ—Å-–ø—Ä–æ—Ü–µ—Å—Å–∞—Ö.

–ì–ª–∞–≤–Ω–∞—è —Ü–µ–ª—å: —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å **—Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö** –¥–∞–∂–µ –ø—Ä–∏ —Å–±–æ—è—Ö.

---

### ‚ö° **–°–≤–æ–π—Å—Ç–≤–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π (ACID)**

- **A ‚Äî Atomicity (–ê—Ç–æ–º–∞—Ä–Ω–æ—Å—Ç—å)**  
    –í—Å—ë –∏–ª–∏ –Ω–∏—á–µ–≥–æ: —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è –ª–∏–±–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é, –ª–∏–±–æ –æ—Ç–∫–∞—Ç (rollback).
    
- **C ‚Äî Consistency (–°–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å)**  
    –ü–æ—Å–ª–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ —Å–∏—Å—Ç–µ–º–∞ –æ—Å—Ç–∞—ë—Ç—Å—è –≤ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Å—É–º–º–∞ –¥–µ–Ω–µ–≥ –Ω–∞ —Å—á–µ—Ç–∞—Ö —Å–æ–≤–ø–∞–¥–∞–µ—Ç).
    
- **I ‚Äî Isolation (–ò–∑–æ–ª—è—Ü–∏—è)**  
    –û–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –Ω–µ –º–µ—à–∞—é—Ç –¥—Ä—É–≥ –¥—Ä—É–≥—É, –¥–∞–∂–µ –µ—Å–ª–∏ –æ–±—Ä–∞—â–∞—é—Ç—Å—è –∫ –æ–¥–Ω–∏–º –¥–∞–Ω–Ω—ã–º.
    
- **D ‚Äî Durability (–ù–∞–¥—ë–∂–Ω–æ—Å—Ç—å/–î–æ–ª–≥–æ–≤–µ—á–Ω–æ—Å—Ç—å)**  
    –ü–æ—Å–ª–µ —Ñ–∏–∫—Å–∞—Ü–∏–∏ (commit) –¥–∞–Ω–Ω—ã–µ –Ω–µ —Ç–µ—Ä—è—é—Ç—Å—è –¥–∞–∂–µ –ø—Ä–∏ —Å–±–æ–µ.
    

---

### üìå **–ü—Ä–∏–º–µ—Ä –Ω–∞ Java (JDBC)**

```java
Connection conn = dataSource.getConnection(); // —Å–æ–∑–¥–∞—ë–º —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ
try {
    conn.setAutoCommit(false); // –≤—ã–∫–ª—é—á–∞–µ–º –∞–≤—Ç–æ–∫–æ–º–º–∏—Ç
    
    PreparedStatement stmt1 = conn.prepareStatement("UPDATE accounts SET balance=balance-100 WHERE id=1");
    stmt1.executeUpdate(); // —Å–ø–∏—Å—ã–≤–∞–µ–º –¥–µ–Ω—å–≥–∏
    
    PreparedStatement stmt2 = conn.prepareStatement("UPDATE accounts SET balance=balance+100 WHERE id=2");
    stmt2.executeUpdate(); // –∑–∞—á–∏—Å–ª—è–µ–º –¥–µ–Ω—å–≥–∏
    
    conn.commit(); // —Ñ–∏–∫—Å–∏—Ä—É–µ–º —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é
} catch (Exception e) {
    conn.rollback(); // –µ—Å–ª–∏ –æ—à–∏–±–∫–∞ ‚Äî –æ—Ç–∫–∞—Ç
}
```

---

### üìä **–¢–∏–ø—ã —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π**

1. **–õ–æ–∫–∞–ª—å–Ω—ã–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏**  
    –í –ø—Ä–µ–¥–µ–ª–∞—Ö –æ–¥–Ω–æ–π –±–∞–∑—ã –∏–ª–∏ —Ä–µ—Å—É—Ä—Å–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –æ–¥–Ω–∞ —Ç–∞–±–ª–∏—Ü–∞ –≤ PostgreSQL).
    
2. **–†–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏**  
    –û—Ö–≤–∞—Ç—ã–≤–∞—é—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–µ—Å—É—Ä—Å–æ–≤ (–Ω–µ—Å–∫–æ–ª—å–∫–æ –ë–î, –æ—á–µ—Ä–µ–¥–∏ —Å–æ–æ–±—â–µ–Ω–∏–π). –î–ª—è —ç—Ç–æ–≥–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è:
    
    - **2PC (Two-Phase Commit)** ‚Äî —Å—Ç—Ä–æ–≥–∞—è –∞—Ç–æ–º–∞—Ä–Ω–æ—Å—Ç—å, –Ω–æ –ø–ª–æ—Ö–æ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ—Ç—Å—è
        
    - [[SAGA|SAGA]] ‚Äî –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ª–æ–∫–∞–ª—å–Ω—ã—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π —Å –∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏–µ–π
        

---

### üß† **–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –∏ –ø–æ–¥–≤–æ–¥–Ω—ã–µ –∫–∞–º–Ω–∏**

- ‚ö†Ô∏è –î–æ–ª–≥–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –±–ª–æ–∫–∏—Ä—É—é—Ç —Ä–µ—Å—É—Ä—Å—ã –∏ —Å–Ω–∏–∂–∞—é—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
    
- ‚ö†Ô∏è –†–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –ø–ª–æ—Ö–æ –º–∞—Å—à—Ç–∞–±–∏—Ä—É—é—Ç—Å—è –≤ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞—Ö
    
- üí° –í –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞—Ö –≤–º–µ—Å—Ç–æ ACID —á–∞—Å—Ç–æ –ø—Ä–∏–º–µ–Ω—è—é—Ç [[SAGA|SAGA]] –∏–ª–∏ [[Event-Driven Architecture|—Å–æ–±—ã—Ç–∏–π–Ω—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É]] —Å eventual consistency
    

---

### üéØ **–í–æ–ø—Ä–æ—Å—ã –Ω–∞ —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏–∏**

1. ‚ùì –ß—Ç–æ —Ç–∞–∫–æ–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è?  
    üëâ –ï–¥–∏–Ω–∏—Ü–∞ —Ä–∞–±–æ—Ç—ã, –∫–æ—Ç–æ—Ä–∞—è –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —Ü–µ–ª–∏–∫–æ–º –∏–ª–∏ –æ—Ç–∫–∞—Ç—ã–≤–∞–µ—Ç—Å—è.
    
2. ‚ùì –ù–∞–∑–æ–≤–∏—Ç–µ —Å–≤–æ–π—Å—Ç–≤–∞ ACID.  
    üëâ –ê—Ç–æ–º–∞—Ä–Ω–æ—Å—Ç—å, –°–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å, –ò–∑–æ–ª—è—Ü–∏—è, –î–æ–ª–≥–æ–≤–µ—á–Ω–æ—Å—Ç—å.
    
3. ‚ùì –ß–µ–º –ª–æ–∫–∞–ª—å–Ω–∞—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è –æ—Ç —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–π?  
    üëâ –õ–æ–∫–∞–ª—å–Ω–∞—è ‚Äî –≤ –æ–¥–Ω–æ–π –ë–î, —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–∞—è ‚Äî –≤ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Ä–µ—Å—É—Ä—Å–∞—Ö.
    
4. ‚ùì –ü–æ—á–µ–º—É –≤ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞—Ö –Ω–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏?  
    üëâ –ü–ª–æ—Ö–æ –º–∞—Å—à—Ç–∞–±–∏—Ä—É—é—Ç—Å—è, –≤–º–µ—Å—Ç–æ –Ω–∏—Ö –ø—Ä–∏–º–µ–Ω—è—é—Ç [[SAGA|—Å–∞–≥–∏]].
    

---

### üîó **–°–≤—è–∑–∞–Ω–Ω—ã–µ —Å—Ç–∞—Ç—å–∏**

- [[ACID]]
    
- [[SAGA]]
    
- [[Orchestration]]
    
- [[Choreography]]
    

---

### üè∑ **–¢–µ–≥–∏**

#database #transaction #acid #java #architecture

---

–•–æ—á–µ—à—å, —è —Å–¥–µ–ª–∞—é –æ—Ç–¥–µ–ª—å–Ω—É—é –∑–∞–º–µ—Ç–∫—É –ø–æ **ACID** –∏ –ø–æ–¥—Ä–æ–±–Ω–æ —Ä–∞–∑–±–µ—Ä—É –∫–∞–∂–¥—ã–π –ø—Ä–∏–Ω—Ü–∏–ø —Å –ø—Ä–∏–º–µ—Ä–∞–º–∏ –∏–∑ SQL –∏ Java?