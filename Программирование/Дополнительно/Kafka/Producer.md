# üìÑ **Producer**

### üìù **–ß—Ç–æ —ç—Ç–æ –∏ –∑–∞—á–µ–º –Ω—É–∂–Ω–æ**

Producer ‚Äî —ç—Ç–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç [[Kafka|Kafka]], –∫–æ—Ç–æ—Ä—ã–π –ø—É–±–ª–∏–∫—É–µ—Ç [[Message|—Å–æ–æ–±—â–µ–Ω–∏—è]] –≤ [[Topic|—Ç–æ–ø–∏–∫]].  
–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–±—ã—Ç–∏–π –∏–ª–∏ –¥–∞–Ω–Ω—ã—Ö –≤ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–π [[Log|–ª–æ–≥]].  
–ì–ª–∞–≤–Ω–∞—è —Ü–µ–ª—å: –æ–±–µ—Å–ø–µ—á–∏—Ç—å –±—ã—Å—Ç—Ä—É—é –∏ –Ω–∞–¥—ë–∂–Ω—É—é –¥–æ—Å—Ç–∞–≤–∫—É [[Message|—Å–æ–æ–±—â–µ–Ω–∏–π]] –≤ –Ω—É–∂–Ω—ã–π [[Partition|–ø–∞—Ä—Ç–∏ÏÖò]].

---

### ‚ö° **–û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏**

- üìç –û—Ç–ø—Ä–∞–≤–∫–∞ [[Message|—Å–æ–æ–±—â–µ–Ω–∏–π]] –≤ [[Topic|—Ç–æ–ø–∏–∫]] —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –≤—ã–±–æ—Ä–æ–º [[Partition|–ø–∞—Ä—Ç–∏—Ü–∏–∏]].
    
- üîë –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —É–∫–∞–∑–∞—Ç—å –∫–ª—é—á –¥–ª—è –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏ [[Message|—Å–æ–æ–±—â–µ–Ω–∏–π]].
    
- ‚ûï –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–π –∏ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏.
    
- ‚ûñ –í–æ–∑–º–æ–∂–Ω—ã–µ –∑–∞–¥–µ—Ä–∂–∫–∏ –ø—Ä–∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–∏ –æ—Ç [[Broker|–±—Ä–æ–∫–µ—Ä–∞]].
    
- üîÑ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ [[acks|acks]] —Ä–µ–∂–∏–º–æ–≤ (0, 1, all).
    
- üö´ –ù–µ—Ç –≥–∞—Ä–∞–Ω—Ç–∏–∏ –ø–æ—Ä—è–¥–∫–∞ –º–µ–∂–¥—É —Ä–∞–∑–Ω—ã–º–∏ [[Partition|–ø–∞—Ä—Ç–∏—Ü–∏—è–º–∏]].
    

---

### üìå **–ü—Ä–∏–º–µ—Ä –∫–æ–¥–∞**

```java
// –ü—Ä–∏–º–µ—Ä –ø—Ä–æ—Å—Ç–æ–≥–æ –ø—Ä–æ–¥—é—Å–µ—Ä–∞ Kafka
import org.apache.kafka.clients.producer.KafkaProducer; // –ö–ª–∞—Å—Å –ø—Ä–æ–¥—é—Å–µ—Ä–∞
import org.apache.kafka.clients.producer.ProducerRecord; // –û–±—ä–µ–∫—Ç —Å–æ–æ–±—â–µ–Ω–∏—è
import java.util.Properties; // –î–ª—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

public class ProducerExample {
    public static void main(String[] args) { // –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞
        Properties props = new Properties(); // –°–æ–∑–¥–∞–µ–º –æ–±—ä–µ–∫—Ç –Ω–∞—Å—Ç—Ä–æ–µ–∫
        props.put("bootstrap.servers", "localhost:9092"); // –ê–¥—Ä–µ—Å –±—Ä–æ–∫–µ—Ä–∞
        props.put("key.serializer", "org.apache.kafka.common.serialization.StringSerializer"); // –°–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–ª—é—á–∞
        props.put("value.serializer", "org.apache.kafka.common.serialization.StringSerializer"); // –°–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è –∑–Ω–∞—á–µ–Ω–∏—è

        KafkaProducer<String, String> producer = new KafkaProducer<>(props); // –°–æ–∑–¥–∞–µ–º –ø—Ä–æ–¥—é—Å–µ—Ä
        producer.send(new ProducerRecord<>("orders", "order-1", "–°–æ–∑–¥–∞–Ω –∑–∞–∫–∞–∑ 123")); // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ
        producer.close(); // –ó–∞–∫—Ä—ã–≤–∞–µ–º –ø—Ä–æ–¥—é—Å–µ—Ä
    }
}
```

---

### üß† **–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –∏ –ø–æ–¥–≤–æ–¥–Ω—ã–µ –∫–∞–º–Ω–∏**

- ‚ùó –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ [[acks|acks]] –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –ø–æ—Ç–µ—Ä–µ [[Message|—Å–æ–æ–±—â–µ–Ω–∏–π]].
    
- üì¶ –ü—Ä–∏ –≤—ã—Å–æ–∫–æ–π –Ω–∞–≥—Ä—É–∑–∫–µ –Ω—É–∂–Ω–æ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å –±—É—Ñ–µ—Ä–∏–∑–∞—Ü–∏—é –∏ batch.size.
    
- üîç –í–æ–∑–º–æ–∂–Ω–∞ –∑–∞–¥–µ—Ä–∂–∫–∞ –∏–∑-–∑–∞ —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏ –º–µ–∂–¥—É [[Broker|–±—Ä–æ–∫–µ—Ä–∞–º–∏]].
    
- üèé –î–ª—è –≤—ã—Å–æ–∫–æ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –ª—É—á—à–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—É—é –æ—Ç–ø—Ä–∞–≤–∫—É.
    

---

### üìä **–í–∏–∑—É–∞–ª—å–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ**

```
[Producer] ---> [Topic: orders] ---> [Partition 0]
                            \---> [Partition 1]
```

---

### üíº **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –Ω–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ**

1. **–ü—Ä–æ—Å—Ç–æ–π –ø—Ä–æ–¥—é—Å–µ—Ä**
    
    ```java
    producer.send(new ProducerRecord<>("logs", "info", "–°–µ—Ä–≤–∏—Å –∑–∞–ø—É—â–µ–Ω")); // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –ª–æ–≥-—Å–æ–æ–±—â–µ–Ω–∏–µ
    ```
    
    ‚úÖ –°–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ø–∞–¥–∞–µ—Ç –≤ —Ç–æ–ø–∏–∫ `logs`.
    
2. **–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ —Å callback**
    
    ```java
    producer.send(new ProducerRecord<>("metrics", "cpu", "80%"), (metadata, ex) -> {
        if (ex != null) {
            System.out.println("–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏: " + ex.getMessage()); // –õ–æ–≥–∏—Ä—É–µ–º –æ—à–∏–±–∫—É
        } else {
            System.out.println("–°–æ–æ–±—â–µ–Ω–∏–µ –¥–æ—Å—Ç–∞–≤–ª–µ–Ω–æ –≤ partition " + metadata.partition()); // –£—Å–ø–µ—à–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞
        }
    });
    ```
    
    ‚úÖ –ú–æ–∂–Ω–æ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç –¥–æ—Å—Ç–∞–≤–∫–∏.
    
3. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–ª—é—á–∞ –¥–ª—è –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏**
    
    ```java
    producer.send(new ProducerRecord<>("orders", "user-42", "–ù–æ–≤—ã–π –∑–∞–∫–∞–∑")); // –°–æ–æ–±—â–µ–Ω–∏–µ —É–π–¥–µ—Ç –≤ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–π partition
    ```
    
    ‚úÖ –í—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è —Å –æ–¥–Ω–∏–º –∫–ª—é—á–æ–º –ø–æ–ø–∞–¥—É—Ç –≤ –æ–¥–∏–Ω [[Partition|–ø–∞—Ä—Ç–∏—Ü–∏—é]].
    

---

### üéØ **–¢–∏–ø–∏—á–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã –Ω–∞ —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏–∏ (—Å –æ—Ç–≤–µ—Ç–∞–º–∏)**

1. ‚ùì –ß—Ç–æ —Ç–∞–∫–æ–µ Producer –≤ Kafka?  
    üëâ –≠—Ç–æ –∫–ª–∏–µ–Ω—Ç, –æ—Ç–ø—Ä–∞–≤–ª—è—é—â–∏–π [[Message|—Å–æ–æ–±—â–µ–Ω–∏—è]] –≤ [[Topic|—Ç–æ–ø–∏–∫]].
    
2. ‚ùì –ö–∞–∫ –ø—Ä–æ–¥—é—Å–µ—Ä –≤—ã–±–∏—Ä–∞–µ—Ç partition?  
    üëâ –ü–æ –∫–ª—é—á—É —Å–æ–æ–±—â–µ–Ω–∏—è –∏–ª–∏ —á–µ—Ä–µ–∑ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è.
    
3. ‚ùì –ö–∞–∫–∏–µ –µ—Å—Ç—å —Ä–µ–∂–∏–º—ã –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –æ—Ç–ø—Ä–∞–≤–∫–∏?  
    üëâ acks=0, 1, all (–æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ, –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ª–∏–¥–µ—Ä–∞, –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –≤—Å–µ—Ö —Ä–µ–ø–ª–∏–∫).
    
4. ‚ùì –ú–æ–∂–Ω–æ –ª–∏ –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ—Ä—è–¥–æ–∫ —Å–æ–æ–±—â–µ–Ω–∏–π?  
    üëâ –î–∞, –Ω–æ —Ç–æ–ª—å–∫–æ –≤–Ω—É—Ç—Ä–∏ –æ–¥–Ω–æ–≥–æ [[Partition|–ø–∞—Ä—Ç–∏—Ü–∏–∏]].
    
5. ‚ùì –ß–µ–º —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è –æ—Ç –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–π?  
    üëâ –°–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –±–ª–æ–∫–∏—Ä—É–µ—Ç –ø–æ—Ç–æ–∫ –¥–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è, –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è —Ä–∞–±–æ—Ç–∞–µ—Ç —á–µ—Ä–µ–∑ callback.
    
6. ‚ùì –ö–∞–∫ –ø—Ä–æ–¥—é—Å–µ—Ä —Å–µ—Ä–∏–∞–ª–∏–∑—É–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è?  
    üëâ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç [[Serializer|—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ç–æ—Ä—ã]] –¥–ª—è –∫–ª—é—á–∞ –∏ –∑–Ω–∞—á–µ–Ω–∏—è.
    
7. ‚ùì –ß—Ç–æ –ø—Ä–æ–∏–∑–æ–π–¥–µ—Ç, –µ—Å–ª–∏ [[Broker|–±—Ä–æ–∫–µ—Ä]] –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω?  
    üëâ –°–æ–æ–±—â–µ–Ω–∏—è –±—É–¥—É—Ç –ø–æ–º–µ—â–µ–Ω—ã –≤ –±—É—Ñ–µ—Ä, –≤–æ–∑–º–æ–∂–Ω—ã –æ—à–∏–±–∫–∏ –ø—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ –ª–∏–º–∏—Ç–æ–≤.
    
8. ‚ùì –ö–∞–∫ –ø—Ä–æ–¥—é—Å–µ—Ä –ø–æ–≤—ã—à–∞–µ—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å?  
    üëâ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç batch –æ—Ç–ø—Ä–∞–≤–∫—É –∏ —Å–∂–∞—Ç–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π.
    
9. ‚ùì –ß—Ç–æ —Ç–∞–∫–æ–µ idempotent producer?  
    üëâ –†–µ–∂–∏–º, –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞—é—â–∏–π –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ [[Message|—Å–æ–æ–±—â–µ–Ω–∏–π]] –ø—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –æ—Ç–ø—Ä–∞–≤–∫–∞—Ö.
    
10. ‚ùì –ú–æ–∂–µ—Ç –ª–∏ –æ–¥–∏–Ω –ø—Ä–æ–¥—é—Å–µ—Ä –ø–∏—Å–∞—Ç—å –≤ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ç–æ–ø–∏–∫–æ–≤?  
    üëâ –î–∞, –ø—Ä–æ–¥—é—Å–µ—Ä –º–æ–∂–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å [[Message|—Å–æ–æ–±—â–µ–Ω–∏—è]] –≤ —Ä–∞–∑–Ω—ã–µ [[Topic|—Ç–æ–ø–∏–∫–∏]].
    

---

### üîó **–°–≤—è–∑–∞–Ω–Ω—ã–µ —Ç–µ—Ä–º–∏–Ω—ã**

- [[Kafka|Kafka]]
    
- [[Topic|—Ç–æ–ø–∏–∫]]
    
- [[Partition|–ø–∞—Ä—Ç–∏—Ü–∏—è]]
    
- [[Consumer|–∫–æ–Ω—Å—É–º–µ—Ä]]
    
- [[Message|—Å–æ–æ–±—â–µ–Ω–∏–µ]]
    
- [[Broker|–±—Ä–æ–∫–µ—Ä]]
    
- [[Serializer|—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ç–æ—Ä]]
    
- [[acks|acks]]
    
- [[Log|–ª–æ–≥]]
    

---

### üè∑ **–¢–µ–≥–∏**

#java #streaming #interview #datastructures

---

–•–æ—á–µ—à—å, —è —Ç–∞–∫ –∂–µ –ø–µ—Ä–µ—Å–º–æ—Ç—Ä—é –≤—Å–µ **–ø—Ä–µ–¥—ã–¥—É—â–∏–µ —Å—Ç–∞—Ç—å–∏** –∏ –∑–∞–º–µ–Ω—é —Å—Å—ã–ª–∫–∏ –≤ –Ω–∏—Ö –Ω–∞ —Ñ–æ—Ä–º–∞—Ç `[[–ê–Ω–≥–ª–∏–π—Å–∫–∏–π|—Ä—É—Å—Å–∫–∏–π]]`, —á—Ç–æ–±—ã –≤—Å—ë –±—ã–ª–æ –µ–¥–∏–Ω–æ–æ–±—Ä–∞–∑–Ω–æ?