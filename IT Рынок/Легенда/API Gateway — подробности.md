API Gateway / BFF — это фасад между клиентским приложением (веб/мобильный) и набором бэкенд-микросервисов. Его основная цель — упростить клиенту интерфейс, реализовать кросс-срезовую логику (аутентификация, агрегация, кеш, защиту) и выступать точкой входа для всех запросов.

Откуда берёт данные

- Прямо из внутренних микросервисов по REST (Tracking Service, Search, Auth, Notification, CRM).
    
- Асинхронно — через Kafka для событий/уведомлений (Gateway может подписываться на SSE/WebSocket-канал или получать push от Notification Service).
    
- Быстрые ответы из Redis (кеш последних статусов, сессии, rate counters).
    

Что делает внутри (функционал)

- Аутентификация/авторизация: проверка JWT/OAuth2 токенов (Spring Security), роль-менеджмент, scopes.
    
- Роутинг & трансформация: маршрутизация запросов к соответствующим сервисам, трансформация payload (API-versioning, адаптация полей для клиентов).
    
- Агрегация/композиция: объединяет ответы нескольких сервисов в один API-ответ (например: shipment + lastEvent + estimatedDelivery). Выполняет параллельные REST вызовы и собирает результат.
    
- Кеширование: ответные кеши в Redis с TTL для «горячих» треков; ETag/If-Modified-Since для снижения трафика.
    
- Rate limiting & throttling: token bucket / leaky bucket по API-ключам/пользователям.
    
- Resilience: circuit breaker, retry, fallback (Resilience4j).
    
- Валидация & контракт: входящий запрос валидируется по OpenAPI/JSON Schema; ошибки консолидируются.
    
- Логирование/трейсинг: OpenTelemetry/Zipkin, корреляция requestId, structured logs.
    
- Security hardening: input sanitization, CORS, CSP, IP whitelisting, WAF hooks.
    

Куда отправляет

- Синхронные REST-вызовы к соответствующим сервисам; агрегированные запросы параллельно.
    
- Публикует аналитические события (request/latency/errors) в Kafka/metrics pipeline.
    
- При push-уведомлениях использует WebSocket/SSE канал к клиентам (через Notification Service или напрямую, если BFF держит сессии).
    

Результат: единая, безопасная и производительная точка входа, минимизирующая сложность клиентской логики и уменьшающая число round-trip’ов.